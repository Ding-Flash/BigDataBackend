(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-070ba94d"],{2615:function(e,t,r){},3846:function(e,t,r){r("9e1e")&&"g"!=/./g.flags&&r("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:r("0bfb")})},5103:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("d2-container",[r("template",{slot:"header"},[e._v("Spark分析报告")]),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:17}},[r("el-card",{staticStyle:{overflow:"auto"},attrs:{shadow:"always"}},[r("div",{attrs:{slot:"header"},slot:"header"},[e._v("Straggler 检测")]),r("div",{staticStyle:{height:"600px"},attrs:{id:"timeline"}})])],1),r("el-col",{attrs:{span:7}},[r("el-card",{staticStyle:{overflow:"auto"},attrs:{shadow:"always"}},[r("div",{attrs:{slot:"header"},slot:"header"},[e._v("Straggler 类型")]),e.stragglers.length>0?r("div",{staticClass:"block",staticStyle:{height:"600px"}},[r("el-timeline",e._l(e.stragglers,function(t,a){return r("el-timeline-item",{key:a,attrs:{timestamp:"Straggler "+a+": task-number "+t.task_number,placement:"top",color:t.task_number>10?"#f54b42":"#4287f5"}},[r("el-card",e._l(t.feature,function(t,a){return r("el-badge",{key:a,staticClass:"item",attrs:{value:t[1]}},[r("el-tag",{attrs:{size:"small",type:e.tag_type[Math.floor(Math.random()*(e.tag_type.length+1))]}},[e._v("\n                              "+e._s(e.f_label[t[0]])+"\n                          ")])],1)}),1)],1)}),1)],1):e._e()])],1)],1),r("br"),r("div",[r("el-card",[r("div",{attrs:{slot:"header"},slot:"header"},[e._v("Straggler 决策树生成")]),r("el-row",{attrs:{type:"flex",justify:"center"}},[e.cart_tree?r("div",[r("org-tree",{attrs:{data:e.cart_tree,collapsable:"","node-render":e.nodeRender,"expand-all":!0,props:e.props}})],1):e._e()])],1)],1)],2)},n=[],s=r("313e"),i=r.n(s),o=(r("28a5"),r("6b54"),function(e,t,r){for(var a=0;a<e.length;a++)if(t===e[a][0]&&r===e[a][1])return"Straggler";return""}),l={getTimelineConfig:function(e,t,r,a){for(var n=[],s=0;s<e;s++)n.push("Task"+s.toString());for(var i=[],l=0;l<t[0].length;l++){for(var u=[],c=0;c<e;c++)u.push(t[c][l]);i.push({type:"bar",stack:"task",data:u,label:{normal:{show:!0,formatter:function(e){return o(r,e.dataIndex,e.seriesIndex)}}}})}var d={title:{show:!0},tooltip:{trigger:"item",formatter:function(e){var t=a[2*e.seriesIndex+1].split("_")[0];void 0===t&&(t="unkown");var n="Operator:"+t+"<br> time: "+e.value+"(ms)";return"Straggler"===o(r,e.dataIndex,e.seriesIndex)&&(n="Straggler Operator <br>"+n),n}},xAxis:{type:"value"},yAxis:{type:"category",data:n},dataZoom:[],series:i};return e>20&&d.dataZoom.push({type:"inside",yAxisIndex:0,start:0,end:10}),d},featuresLabels:["Long_Serialization","Long_Deserialization","CPU_Abnormal","Out_Of_Memory","Too_Much_GC","Too_Much_Remote_Fetch","Read_Key_Skew","Read_Value_Skew","Write_Key_Skew","Write_Value_Skew","Bad_Data_Locality","Busy_CPU","Busy_Disk_I/O","Busy_Network","HDFS_Read_Skew","Data_Write_Busy","HDFS_Write_Skew","Unknown_Reason"]},u=r("9a0d"),c=r.n(u),d=r("7261"),g={name:"index",created:function(){var e=this,t=this.$store.state.spark.currentTaskName;""===t?(this.$router.push({name:"history"}),this.$notify({title:"注意",message:"请选择或创建task",type:"warning"})):(Object(d["d"])({name:t}).then(function(t){t=t.data,e.getTimeline(t)}),this.getStraggler(t),this.getTree(t))},components:{OrgTree:c.a},data:function(){return{stragglers:[],f_label:l.featuresLabels,tag_type:["primary","success","warning","danger","info"],props:{id:"name",label:"label",expand:"expand",children:"childs"},cart_tree:null}},methods:{getTimeline:function(e){var t=i.a.init(document.getElementById("timeline")),r=l.getTimelineConfig(e.task_num,e.op_list,e.straggler_op_location_list,e.op_name_list);t.setOption(r,{notMerge:!0})},getStraggler:function(e){var t=this;Object(d["c"])({name:e}).then(function(e){t.stragglers=e.data.straggler_type})},getTree:function(e){var t=this;Object(d["b"])({name:e}).then(function(e){t.cart_tree=e})},nodeRender:function(e,t){return e("el-card",Array.apply(null,t.label.map(function(t){return e("el-alert",{props:{center:!0,effect:"dark",closable:!1}},t)})))}}},f=g,p=(r("578b"),r("2877")),_=Object(p["a"])(f,a,n,!1,null,null,null);_.options.__file="index.vue";t["default"]=_.exports},"578b":function(e,t,r){"use strict";var a=r("2615"),n=r.n(a);n.a},"6b54":function(e,t,r){"use strict";r("3846");var a=r("cb7c"),n=r("0bfb"),s=r("9e1e"),i="toString",o=/./[i],l=function(e){r("2aba")(RegExp.prototype,i,e,!0)};r("79e5")(function(){return"/a/b"!=o.call({source:"a",flags:"b"})})?l(function(){var e=a(this);return"/".concat(e.source,"/","flags"in e?e.flags:!s&&e instanceof RegExp?n.call(e):void 0)}):o.name!=i&&l(function(){return o.call(this)})},7261:function(e,t,r){"use strict";r.d(t,"d",function(){return n}),r.d(t,"c",function(){return s}),r.d(t,"b",function(){return i}),r.d(t,"e",function(){return o}),r.d(t,"a",function(){return l});r("cadf"),r("551c"),r("097d");var a=r("9bd2");function n(e){return Object(a["a"])({url:"/spark/timeline",method:"GET",params:e})}function s(e){return Object(a["a"])({url:"/spark/straggler",method:"GET",params:e})}function i(e){return Object(a["a"])({url:"/spark/cart_tree",method:"GET",params:e})}function o(){return Object(a["a"])({url:"/spark/gettasklist",method:"GET"})}function l(e){return Object(a["a"])({url:"/spark/delete",method:"GET",params:e})}}}]);
//# sourceMappingURL=chunk-070ba94d.ae2a378e.js.map